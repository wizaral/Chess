CC = g++
NAME = chess.exe
TEST = test.exe

LOGIC_FILES = \
	base\board \
	base\factory \
	base\figure \
	base\game \
	base\gamestate \
	base\logic \
	base\move \
	base\observer \
	base\player \
	base\position \
	strategies\bishop \
	strategies\king \
	strategies\knight \
	strategies\pawn \
	strategies\queen \
	strategies\rook \

VIEW_FILES = \
	console\input \
	console\main \
	console\render \

TESTS_FILES = \
	file_factory \
	input \
	render \
	tests\


LOGIC = $(LOGIC_FILES:%=.\logic\src\\%.cpp)
VIEW = $(VIEW_FILES:%=.\view\src\\%.cpp)
TESTS = $(TESTS_FILES:%=.\tests\src\\%.cpp)

WFLAGS = -Wall -Wextra -Werror -Wpedantic -Wno-unused-variable -Wno-unused-function -Wno-unused-parameter
LFLAGS = -I.\logic\inc -I.\view\inc -I.\tests\inc
OFLAGS = -Ofast -march=native -fomit-frame-pointer -flto
# OFLAGS = -O0 -g3 -ftrapv -fno-omit-frame-pointer
SFML = -I.\SFML-2.5.1\include\ -L.\SFML-2.5.1\lib\ -lsfml-graphics -lsfml-window -lsfml-system -lsfml-network -lsfml-audio

COMPILE = $(CC) -std=c++17 -pipe $(WFLAGS) $(LFLAGS) $(OFLAGS)
RM = del

all: $(NAME)

$(NAME): $(LOGIC) $(VIEW)
	@$(COMPILE) $^ -o $@

test: $(TEST)

$(TEST): $(LOGIC) $(TESTS)
	@$(COMPILE) $^ -o $@

uninstall:
	@$(RM) $(NAME)

reinstall: uninstall all

.PHONY: all uninstall reinstall

sfml:
	@$(CC) -std=c++17 -pipe $(WFLAGS) $(SFML) $(OFLAGS) .\view\graphics\main.cpp -o sfml
